\documentclass[a4paper,14pt]{extarticle}
\usepackage{geometry}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[english,russian]{babel}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{fancyhdr}
\usepackage{setspace}
\usepackage{graphicx}
\usepackage{colortbl}
\usepackage{tikz}
\usepackage{pgf}
\usepackage{subcaption}
\usepackage{listings}
\usepackage{indentfirst}
\usepackage[colorlinks,citecolor=blue,linkcolor=blue,bookmarks=false,hypertexnames=true, urlcolor=blue]{hyperref}
\usepackage{indentfirst}
\usepackage{mathtools}
\usepackage{booktabs}
\usepackage[flushleft]{threeparttable}
\usepackage{tablefootnote}

\usepackage{chngcntr} % нумерация графиков и таблиц по секциям
\counterwithin{table}{section}
\counterwithin{figure}{section}

\usepackage[backend=biber, citestyle=authoryear]{biblatex}
\addbibresource{bibliography.bib}
\DeclareFieldFormat{labelnumberwidth}{#1\adddot}
\setlength{\biblabelsep}{5pt}

\makeatletter
\renewcommand{\@biblabel}[1]{#1.} % Заменяем библиографию с квадратных скобок на точку:
\makeatother

\geometry{left=1.5cm}% левое поле
\geometry{right=1.5cm}% правое поле
\geometry{top=1.5cm}% верхнее поле
\geometry{bottom=1.5cm}% нижнее поле

\renewcommand{\theenumi}{\arabic{enumi}}% Меняем везде перечисления на цифра.цифра
\renewcommand{\labelenumi}{\arabic{enumi}}% Меняем везде перечисления на цифра.цифра
\renewcommand{\theenumii}{.\arabic{enumii}}% Меняем везде перечисления на цифра.цифра
\renewcommand{\labelenumii}{\arabic{enumi}.\arabic{enumii}.}% Меняем везде перечисления на цифра.цифра
\renewcommand{\theenumiii}{.\arabic{enumiii}}% Меняем везде перечисления на цифра.цифра
\renewcommand{\labelenumiii}{\arabic{enumi}.\arabic{enumii}.\arabic{enumiii}.}% Меняем везде перечисления на цифра.цифра

\DeclareMathOperator{\chr}{char}

\begin{document}
\input{title.tex}% это титульный лист
\newpage

{
    \hypersetup{linkcolor=black}
    \tableofcontents
}

\newpage

\section{Введение}

Целью данной курсовой работы является знакомство с эллиптическими кривыми и их
применением в криптографии. В ходе её выполнения мной был повторён и изучен
необходимый алгебраический аппарат, базовые алгоритмы из несимметрической
криптографии (криптографии с открытым ключом) и был написан код на Rust с
имплементацией (де)шифратора на основе эллиптических кривых.

\newpage

\section{Необходимые определения}

\subsection{Из коммутативной алгебры}

\begin{itemize}
    \item Для \textbf{моноида} $(G, +, 0)$ выполнено:
        \begin{itemize}
            \item $G$ --- множество (не обязательно конечное);
            \item $+: G \times G \to G$ --- ассоциативная операция;
            \item $0 \in G$ нейтрален относительно $+$.
        \end{itemize}
    \item \textbf{Группа} $(G, +, 0, -)$ --- кортеж, для которого
        выполено:
        \begin{itemize}
            \item $(G, +, 0)$ --- моноид;
            \item для $-: G \to G$ выполнено $g + (-g) = 0$.
        \end{itemize}
    \item Алгебраическая структура называется \textbf{коммутативной}, если
        ассоциированная с ней операция коммутативна. Коммутативные группы обычно
        называются абелевыми.
    \item \textbf{Циклическая группа} --- группа $(G, +, 0, -)$, для которой
        существует генератор $g \in G$, т.е. для любого $h \in G$ есть
        $n \in \mathbb{N}$ такое, что $h = g \cdot n$, где $g \cdot n$ ---
        применение $+ g$ к $0$ $n$ раз.

        Несложно заметить, что циклическая группа является абелевой.
    \item \textbf{Поле} $(F, +, 0, -, \times, 1, \square^{-1})$ --- кортеж,
        обладающий следующими свойствами:
        \begin{itemize}
            \item $(F, +, 0, -)$ --- абелева группа;
            \item $0 \ne 1$;
            \item $(F, \times, 1)$ --- коммутативный моноид;
            \item $(F \setminus \{0\}, \times, 1, \square^{-1})$ --- тоже
                абелева группа (в частности, $\times$ замкнута относительно
                $F \setminus \{0\}$);
            \item $\times$ дистрибутивно относительно $+$.
        \end{itemize}
    \item \textbf{Характеристика поля} $\chr F$ --- такое $n \in \mathbb{N}$,
        что $1_F \cdot n = 0_F$.
    \item Пусть $\mathbb{F}$ --- произвольное поле. Тогда мы можем определить
        \textbf{эллиптическую кривую} как гладкую кривую в $\mathbb{F}^2$,
        которая задаётся уравнением
        \[
            y^2 + a x y + b y = x^3 + c x^2 + d x + e,
        \]
        Где коэффициенты выбираются из поля $\mathbb{F}$.

        Если $\chr F > 3$, то это уравнение с помощью замены
        координат можно привести к форме
        \[
            y^2 = x^3 + a x + b.
        \]
        Критерий гладкости: $4 a^3 + 27 b^2 \ne 0$.
    \item \textbf{Проективное пространство} над полем $\mathbb{F}$ ---
        пространство прямых некоторого линейного пространства над $\mathbb{F}$.
        Точки этого пространства можно описывать с помощью однородных координат,
        т.е. координат точек исходного пространства с определённым на них
        отношением эквивалентности $\sim$:
        \[
            \forall \lambda \in \mathbb{F} \setminus \{0\}: x \sim \lambda x.
        \]
\end{itemize}

\newpage

\subsection{Из криптографии}

\begin{itemize}
    \item \textbf{Схема приватного шифрования}
        $(\verb|Gen|, \verb|Enc|, \verb|Dec|)$ --- тройка функций, где
        \begin{itemize}
            \item $\verb|Gen|: (R, \mathbb{N}) \to K$ --- генератор приватного
                ключа,
            \item $\verb|Enc|: (K, R, M) \to C$ --- операция шифрования,
            \item $\verb|Dec|: (K, C) \to M \sqcup \bot$ --- операция
                дешифровки,
            \item $R$ --- множество источников (псевдо)случайных чисел,
            \item $K$ --- пространство приватных ключей,
            \item $M$ --- пространство передаваемых сообщений,
            \item $C$ --- пространство шифров.
        \end{itemize}
        Как следует из сигнатуры \verb|Dec|, дешифровка имеет право провалиться,
        если ей будет передан невалидный шифр.
    \item \textbf{Схема публичного шифрования}
        (\verb|Gen|, \verb|Enc|, \verb|Dec|) --- другая тройка функций. Для неё
        должно быть выполнено следующее:
        \begin{itemize}
            \item $\verb|Gen|: (R, \mathbb{N}) \to (S, P)$ --- генератор пары
                из тайного и публичного ключа,
            \item $\verb|Enc|: (P, R, M) \to C$ --- операция шифрования,
            \item $\verb|Dec|: (S, C) \to M \sqcup \bot$ --- операция
                дешифровки,
            \item $S$ --- пространство тайных (приватных) ключей,
            \item $P$ --- пространство публичных ключей.
        \end{itemize}
        Обозначения и оговорка про провал дешифровки те же, что выше.
    \item Тройка функций $(\verb|Gen|, \verb|Encaps|, \verb|Decaps|)$ называется
        \textbf{Механизмом инкапсуляции ключа}, если
        \begin{itemize}
            \item $\verb|Gen|: R \to (S, P)$ --- генератор пары
                из ``базовых'' тайного и публичного ключа;
            \item $\verb|Encaps|: (P, R) \to (C, K)$ --- генератор сессионного
                ключа и его шифра;
            \item $\verb|Decaps|: (S, C) \to K \sqcup \bot$ --- алгоритм
                получения сессионного ключа по его шифру.
        \end{itemize}
    \item \textbf{Задача дискретного логарифмирования} формулируется так: дана
        циклическая группа $(G, +, \dots)$, её генератор $g$ и некоторый
        $h \in G$. Требуется найти $k \in \mathbb{N}$ такое, что
        $g \cdot k = h$.

        Задача дискретного логарифмирования называется
        \textbf{сложной относительно} $G$, если для любого её полиномиального
        вероятностного решения вероятность правильного ответа ограничена сверху
        пренебрежимо малой по сравнению с $\log(|G|)$ величиной.
    \item \textbf{Вычислительная задача Диффи-Хеллмана} (CDH): дана циклическая
        группа $(G, +, \dots)$, её генератор $g$ и некоторые
        $g \cdot a, g \cdot b \in G$. Требуется найти $g \cdot (a \cdot b)$.

        Определение \textbf{сложности относительно} $G$ аналогично дискретному
        логарифмированию.
    \item \textbf{Распознавательная задача Диффи-Хеллмана} (Decisional
        Diffie-Hellman, DDH) состоит в отличении случайно выбранного элемента
        $G$ от результата CDH. Другими словами, даны случайные $g \cdot a$,
        $g \cdot b$ и $h$. Нужно ответить, правда ли, что
        $h = g \cdot (a \cdot b)$, или $h$ тоже был выбран случайно.

        Пусть $\mathcal{G}(r, n)$ --- алгоритм генерации случайной группы $G$
        такой, что $2^n \le |G| < 2^{n + 1}$ ($r$ --- источник случайности).
        Тогда DDH называется \textbf{сложной относительно} $\mathcal{G}$, если
        для любого вероятностного алгоритма $\mathcal{A}$ выполнено

        \begin{multline*}
            \bigg| P \Big[
                \mathcal{A}(G, |G|, g, g \cdot x, g \cdot y, g \cdot z) = 1
            \Big] -\\- P \Big[ \mathcal{A}(
                G, |G|, g, g \cdot x, g \cdot y, g \cdot (x \cdot y)
            ) = 1 \Big] \bigg| \le \mathrm{negl}(n),
        \end{multline*}

        где $G$ и $g$ генерируются $\mathcal{G}$, $x, y, z$
        выбираются случайно и равномерно, а $\mathrm{negl}(n)$ --- пренебрежимо
        малая по сравнению с $n$ величина.
    \item \textbf{Chosen plaintext attack} --- атака на схему шифрования, в ходе
        которой злоумышленник может выбирать, какие сообщения будут посланы
        через канал связи, и читать получившиеся шифры. Схемы, устойчивые к
        таким атакам, называются \textbf{CPA-secure}.
    \item \textbf{Chosen ciphertext attack} --- усиленная версия CPA-атаки. В
        рамках CCA-атаки злоумышленник может также запрашивать расшифровку
        произвольных шифров. Схемы, устойчивые к таким атакам, называются
        \textbf{CCA-secure}.
    \item \textbf{Двусторонняя функция} --- такая функция, что и вычисление
        образа, и вычисление прообраза имеют близкую асимптотическую сложность.
    \item \textbf{Односторонняя функция} --- такая функция, для которой
        вычисление прообраза асимптотически гораздо сложнее вычисления образа.
\end{itemize}

\newpage

\section{Эллиптические кривые и группы}

Возьмём произвольное поле $\mathbb{F}$ с $\chr \mathbb{F} > 3$. Добавим в
$\mathbb{F}^2$ точку ``на бесконечности'' $\mathcal{O}$. Во-первых, мы таким
образом получим проективное пространство над $\mathbb{F}^3$; во-вторых, точки на
произвольной эллиптической кривой вместе с $\mathcal{O}$ образуют группу. Если
конкретно, $\mathcal{O}$ --- ноль группы, обратная точка --- отражение точки
относительно оси $0x$, а операция группы $p + q$ определена так:

\begin{itemize}
    \item Если одна из точек --- бесконечная, ответ очевиден.
    \item Если $p = q$, проведём касательную к кривой в точке $p = q$.
        Полученная прямая либо параллельна $0y$ (и тогда $p + q = \mathcal{O}$),
        либо пересекает кривую в ещё одной точке $r$.
    \item Иначе проведём прямую через $p$ и $q$. Она либо касается кривой в
        одной из указанных точек, назовём её $r$, либо пересекается с кривой ещё
        в одной точке $r$.
\end{itemize}

По определению $p + q \vcentcolon= -r$. Заметим, что в рассуждениях выше мы
делали достаточно сильные утверждения про геометрию эллиптических кривых; это
сильный результат, полученный в [???].

Кроме того, в [???] были получены алгебраические формулы для вычисления $p + q$:
пусть $p = (x_p, y_p)$, $q = (x_q, y_q)$ (иначе ответ очевиден).

\begin{itemize}
    \item Если $x_p \ne x_q$, тогда $p + q = (x_r, y_r)$, где
        \[
            \begin{array}{rcl}
                m &=& \frac{y_q - y_p}{x_q - x_p}; \\
                x_r &=& m^2 - x_p - x_q; \\
                y_r &=& m \cdot (x_p - x_r) - y_p.
            \end{array}
        \]
    \item Если $x_p = x_q$, но $y_p \ne y_q$, то $p = -q$, так что
        $p + q = \mathcal{O}$.
    \item Если $p = q$ и $y_p = y_q = 0$, то $p + q = \mathcal{O}$.
    \item Если $p = q = (x, y)$, но $y \ne 0$, то $2 p = (x', y')$, где
        \[
            \begin{array}{rcl}
                y^2 &=& x^3 + a x + b \text{ --- уравнение кривой}; \\
                m &=& \frac{3 x^2 + a}{2 y}; \\
                x' &=& m^2 - 2 x; \\
                y' &=& m \cdot (x - x') - y.
            \end{array}
        \]
\end{itemize}

Для криптографии ценность групп на основе эллиптических кривых заключается в
том, что задачи дискретного логарифмирования и CDH сложны относительно многих из
них. Более того, для получения такой же сложности с помощью циклических подгрупп
$\mathbb{Z}_p^*$ параметр $p$ нужно выбирать гораздо больше, чем соответствующие
параметры кривой (и, следовательно, и памяти нужно больше, и работать алгоритмы
будут дольше) [???].

\newpage

\section{Некоторые криптографические алгоритмы на основе эллиптических кривых}

\subsection{Схема публичного шифрования Эль-Гамаля}

На самом деле, схема Эль-Гамаля может использовать произвольный алгоритм
генерации группы $\mathcal{G}$. Сама схема выглядит следующим образом:

\begin{itemize}
    \item $\verb|Gen|: (R, \mathbb{N}) \to (S, P)$: запустить $\mathcal{G}$ на
        входных аргументах, получить группу $G$, её порядок $q$ и генератор $g$.
        Выбрать случайный $x \in \mathbb{Z}_q$, вычислить
        $h \vcentcolon= g \cdot x$. Публичный ключ --- $(G, q, g, h)$,
        приватный --- $(G, q, g, x)$. Пространство сообщений --- $G$.
    \item $\verb|Enc|: (P, R, G) \to C$: выбрать случайное $y \in \mathbb{Z}_q$,
        шифром будет $(g \cdot y, h \cdot y + m)$, где $m$ --- исходное
        сообщение.
    \item $\verb|Dec|: (S, (G, G)) \to G$: пусть $(c_1, c_2)$ --- переданный
        шифр. Было зашифровано $c_2 - c_1 \cdot x$.
\end{itemize}

При условии сложности DDH относительно $\mathcal{G}$ схема Эль-Гамаля устойчива
к CPA-атакам [???].

\subsection{Механизм инкапсуляции ключа Эль-Гамаля}

Аналогично предыдущему пункту, можно использовать любой $\mathcal{G}$, не только
для эллиптических кривых.

Итак, механизм инкапсуляции ключа a-la Эль-Гамаль:

\begin{itemize}
    \item $\verb|Gen|: (R, \mathbb{N}) \to (S, P)$: запустить $\mathcal{G}$ на
        входных аргументах, получить группу $G$, её порядок $q$ и генератор $g$.
        Выбрать случайный $x \in \mathbb{Z}_q$, вычислить
        $h \vcentcolon= g \cdot x$. Задать функцию $H: G \to \{0, 1\}^{l(n)}$,
        где $l$ является деталью реализации. Публичный ключ ---
        $(G, q, g, h, H)$, приватный --- $(G, q, g, x, H)$.
    \item $\verb|Encaps|: (P, R) \to (C, K)$. Выберем случайный
        $y \in \mathbb{Z}_q$. Шифром будет $g \cdot y$, ключом ---
        $H(h \cdot y)$.
    \item $\verb|Decaps|: (S, C) \to M$: для шифра $c$ ключом является
        $H(c \cdot x)$.
\end{itemize}

\newpage

\section{От алгоритмов к шифрованию}

В предыдущей секции мы рассмотрели алгоритмы, позволяющие шифровать $O(1)$
элементов некоторой группы $G$ и инкапсулировать ключи. Однако на практике нам
1) нужно шифровать бинарные сообщения произвольной длины; 2) не нужно
инкапсулировать какие-то там ключи. В данной секции мы заполним пробелы и
покажем, как компонировать эти алгоритмы.

\subsection{Шифрование потока данных}

Допустим, у нас есть схема шифрования одного элемента некой группы $G$ с помощью
элементов множества $M$. Для начала заметим, что тогда у нас есть схема
шифрования $\lfloor \log(|G|) \rfloor$ бит с помощью $\lceil \log(|M|) \rceil$
бит:

\begin{itemize}
    \item При шифровке отобразим шифруемые биты в группу $G$ заранее
        зафиксированной двусторонней инъекцией; полученный шифр можно инъективно
        отобразить в $\{0, 1\}^{\lceil \log(|M|) \rceil}$.
    \item При дешифровке нужно сначала отобразить биты обратно в $M$ (если у бит
        нет прообраза, вернуть $\bot$); после дешифровки нужно отобразить
        $g \in G$ обратно в $\{0, 1\}^{\lfloor \log(|G|) \rfloor}$ (если у $g$
        нет прообраза, вернуть $\bot$).
\end{itemize}

Очевидно, что устойчивость схемы шифрования от этого не меняется, поскольку
односторонняя функция шифрования компонировалась с двусторонними энкодингами.

Далее, если у нас есть схема шифрования $k_1$ бит с помощью $k_2$ бит, у нас
есть схема шифрования $n k_1$ бит с помощью $n k_2$ для любых
$n, k \in \mathbb{N}$: нужно просто разбить шифруемый поток на чанки длины
$k_1$, зашифровать каждый, сконкатенировать; для дешифровки алгоритм аналогичен.

Но это очевидно; интересно то, что при этом устойчивость схемы шифрования тоже
не меняется, как показано в [???].

Таким образом, алгоритмов из предыдущей секции достаточно, чтобы шифровать
произвольные последовательности.

\subsection{Гибридная схема шифрования}

Механизмы инкапсуляции ключа были введены не просто так: это базовый блок для
\textbf{гибридной схемы шифрования}, основная идея которой заключается в том,
чтобы шифровать каждое сообщение своим ключом, который передаётся вместе с
сообщением (само собой, ключ тоже зашифрован).

Более формально, пусть $(\verb|Gen|', \verb|Encaps|, \verb|Decaps|)$ ---
механизм инкапсуляции ключа некоторой приватной схемы шифрования
$(\_, \verb|Enc|', \verb|Dec|')$. Тогда можно построить
\textbf{гибридную схему публичного шифрования}:

\begin{itemize}
    \item $\verb|Gen| = \verb|Gen|'$;
    \item $\verb|Enc|: (P, R, M) \to C$: запустим \verb|Encaps| на $(P, R)$,
        получим $(c_1, k)$. С помощью $\verb|Enc|'$ и $k$ зашифруем сообщение,
        получим шифр $c_2$. Итоговым шифром будет $(c_1, c_2)$.
    \item $\verb|Dec|: (S, (C_1, C_2)) \to M \sqcup \bot$: сначала попытаемся
        получить ключ с помощью $\verb|Decaps|(S, C_1)$. В случае успеха
        попытаемся расшифровать $C_2$ полученным ключом.
\end{itemize}

Одной из самых известных гибридных схем шифрования является ECIES, Elliptic
Curve Integrated Encryption Scheme. В ней в качестве механизма инкапсуляции
используется механизм Эль-Гамаля. Причём, в отличие от публичной схемы
шифрования Эль-Гамаля, ECIES устойчива к CCA-атакам [???].

\newpage

\section{Тонкости реализации}

\subsection{Однородные координаты}

Как правило, вычисление обратного по умножению в конечном поле --- затратная по
времени операция. И она, как можно заметить в разделе [???], используется при
сложении двух точек на эллиптической кривой. К счастью, точки находятся в
проективном пространстве, так что мы можем использовать однородные координаты и
избежать деления почти полностью (в конце всё равно нужно будет привести точки к
каноническому виду, потому что иначе злоумышленник может получить дополнительную
информацию о производившихся в процессе шифрования действиях). Если быть точным,
формулы приобретают следующий вид: пусть $p = (x_p, y_p, z_p)$,
$q = (x_q, y_q, z_q)$; тогда

\begin{itemize}
    \item Если $p \ne q$, $p + q = (x, y, z)$, где
        \[
            \begin{array}{rcl}
                u &=& y_q z_p - y_p z_q; \\
                v &=& x_q z_p - x_p z_q; \\
                w &=& u^2 z_p z_q - v^3 - 2 v^2 x_p z_q; \\
                q &=& v^3 y_p z_q; \\
                x &=& v w; \\
                z &=& z_p z_q v^3; \\
                y &=& u \cdot (v^2 x_p z_q - w) - q.
            \end{array}
        \]
    \item Если $p = q$ и $p \ne -q$, то $p + q = (x, y, z)$, где
        \[
            \begin{array}{rcl}
                y^2 &=& x^3 + a x + b \text{ --- уравнение кривой}; \\
                q &=& 2 y z; \\
                n &=& 3 x^2 + a z^2; \\
                p &=& 4 x y^2 z; \\
                u &=& n^2 - 2 p; \\

                x &=& u q; \\
                z &=& q^3; \\
                y &=& n \cdot (p - u) - 8 y^4 z^2.
            \end{array}
        \]
\end{itemize}

\subsection{Генерация групп на эллиптических кривых}

Схема Эль-Гамаля предполагает генерацию случайного генератора группы. По теореме
Лагранжа, если взять эллиптическую кривую, которая проходит через $p - 1$ точку,
любая точка на кривой будет генератором. Таким образом, достаточно научиться
выбирать случайную точку на кривой. Но есть одна загвоздка: для этого нужно либо
выбирать случайный $y$ и решать кубическое уравнение на $x$ в произвольном поле,
либо выбирать случайный $x$ и вычислять корень из $x^3 + a x + b$. К счастью, в
[???] приведены детерминированный алгоритм вычисления корня для некоторых
специальных полей и вероятностный алгоритм для вычисления корня в произвольном
поле. В нашей имплементации реализован тривиальный случай для $\mathbb{Z}_p$
при условии $p = 3 \mod \;4$: в этом случае для вычисления $\sqrt{x}$ достаточно
вычислить $x^{(p + 1) / 4}$ и проверить, является ли это решением.

Другой, менее честный вариант: аналитически найти какую-нибудь одну точку $g$ на
кривой. Если порядок группы $p$ простой, она будет генератором, и все её степени
(кроме $\mathcal{O}$) тоже будут генераторами. Выберем случайную степень
$x \in \{1,\dots,p - 1\}$; $g \cdot x$ будет нашим случайным генератором.

\subsection{Энкодинг бит точками на кривой}

В секции [???] мы обсудили, что для кодирования произвольного текста с помощью
элементов группы достаточно ввести двустороннюю инъекцию из пространства букв в
элементы группы. Лежащий на поверхности вариант ``взять генератор $g$,
закодировать букву $x$ как $g \cdot x$'' не подходит, поскольку эта функция
односторонняя, обратная к ней --- дискретный логарифм!

В [???] предложен неплохой алгоритм, который, однако, работает только для полей
вида $\mathbb{Z}_q$. Если кратко, алгоритм состоит в следующем:

\begin{itemize}
    \item Выделить в $\mathbb{Z}_q$ бакеты, в каждом из которых есть $x$, для
        которого есть $y$ такой, что $y^2 = x^3 + a x + b$;
    \item Поставить каждой букве в соответствие бакет, при энкодинге находить
        $x$ линейным поиском внутри бакета, при декодинге определять букву по
        бакету. Заметим, что здесь опять нужно вычисление корня в поле; алгоритм
        мы уже обсудили в секции [???].
\end{itemize}

Структура $\mathbb{Z}_q$ здесь используется только для того, чтобы соответствие
бакета букве вычислялось простыми линейными функциями. Есть основания полагать,
что существует эффективное обобщение алгоритма на произвольное поле.

\newpage

\printbibliography[heading=bibintoc]

\end{document}
